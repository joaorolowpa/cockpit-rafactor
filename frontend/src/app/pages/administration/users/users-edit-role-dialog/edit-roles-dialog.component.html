<div class="dialog-overlay" (click)="onClose()">
  <div class="dialog-content" (click)="$event.stopPropagation()">
    <div class="dialog-header">
      <div>
        <h2>Change Roles</h2>
        <p class="user-name">{{ user().name }}</p>
      </div>
      <p-button
        icon="pi pi-times"
        styleClass="close-btn p-button-text p-button-plain"
        (onClick)="onClose()"
      />
    </div>

    <div class="dialog-body">
      <p class="description">Select the roles you want to assign to this user.</p>

      <div class="roles-grid">
        @for (role of availableRoles; track role) {
          <label class="role-item">
            <p-checkbox
              [binary]="true"
              [ngModel]="isRoleSelected(role)"
              (onChange)="toggleRole(role)"
            />
            <span class="role-label">{{ role }}</span>
          </label>
        }
      </div>

      <!-- Summary Section -->
      <div class="summary-section">
        <div class="summary-header" (click)="toggleSummary()">
          <h4>Active Roles Summary</h4>
          <p-button
            type="button"
            [icon]="showSummary() ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"
            styleClass="toggle-btn p-button-text p-button-plain"
            (onClick)="toggleSummary()"
          />
        </div>
        
        @if (showSummary()) {
          <div class="summary-content">
            @if (selectedRoles().length === 0) {
              <p class="no-roles-selected">No roles selected</p>
            } @else {
              <div class="selected-roles">
                @for (role of selectedRoles(); track role) {
                  <span class="role-badge">{{ role }}</span>
                }
              </div>
            }
          </div>
        }
      </div>
    </div>

    <div class="dialog-footer">
      <p-button
        type="button"
        label="Cancel"
        styleClass="cancel-btn p-button-text p-button-plain"
        (onClick)="onClose()"
      />
      <p-button
        type="button"
        label="Save Changes"
        styleClass="submit-btn"
        [loading]="isSubmitting()"
        [disabled]="isSubmitting()"
        (onClick)="onSubmit()"
      />
    </div>
  </div>
</div>
