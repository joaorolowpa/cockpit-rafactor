<app-dialog title="Change Roles" [subtitle]="user().name" (close)="onClose()">
  <p class="description">Select the roles you want to assign to this user.</p>

  <div class="roles-grid">
    @for (role of availableRoles; track role) {
      <app-checkbox
        class="role-item"
        [checked]="isRoleSelected(role)"
        (checkedChange)="toggleRole(role)"
        [label]="role"
      ></app-checkbox>
    }
  </div>

  <!-- Summary Section -->
  <div class="summary-section">
    <div class="summary-header" (click)="toggleSummary()">
      <h4>Active Roles Summary</h4>
      <button
        type="button"
        class="btn btn-icon btn-text toggle-btn"
        (click)="toggleSummary()"
      >
        <i [class]="showSummary() ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></i>
      </button>
    </div>
    
    @if (showSummary()) {
      <div class="summary-content">
        @if (selectedRoles().length === 0) {
          <p class="no-roles-selected">No roles selected</p>
        } @else {
          <div class="selected-roles">
            @for (role of selectedRoles(); track role) {
              <span class="role-badge">{{ role }}</span>
            }
          </div>
        }
      </div>
    }
  </div>

  <div dialog-footer>
    <button
      type="button"
      class="btn btn-ghost cancel-btn"
      (click)="onClose()"
    >
      Cancel
    </button>
    <button
      type="button"
      class="btn btn-primary"
      [disabled]="isSubmitting()"
      (click)="onSubmit()"
    >
      <span>Save Changes</span>
      @if (isSubmitting()) {
        <span class="btn-spinner" aria-hidden="true"></span>
      }
    </button>
  </div>
</app-dialog>
