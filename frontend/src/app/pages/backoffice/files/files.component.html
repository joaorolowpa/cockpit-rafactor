<div appPageContainer>
  <div appPageHeader>
    <div>
      <h1 class="page-title">Files</h1>
      <p class="page-subtitle">Upload and manage files</p>
    </div>
    <div appPageActions>
      <button
        appButton
        class="btn btn-primary"
        type="button"
        (click)="handleUpload()"
        [disabled]="!canUpload()"
      >
        @if (isProcessing()) {
          <i class="pi pi-spinner pi-spin"></i>
        }
        <span>{{ isProcessing() ? 'Uploading...' : 'Upload' }}</span>
      </button>
    </div>
  </div>

  <div class="tabs">
    @for (tab of tabs; track trackByTab($index, tab)) {
      <button
        class="tab-btn"
        type="button"
        [class.active]="activeTab() === tab.key"
        (click)="setTab(tab.key)"
        [attr.data-tooltip]="tab.label"
        [attr.aria-label]="tab.label"
      >
        <i [class]="tab.icon"></i>
        <span class="tab-label">{{ tab.label }}</span>
      </button>
    }
  </div>

  <div class="upload-card">
    <div
      class="upload-drop"
      [class.dragging]="isDragging()"
      (dragover)="onDragOver($event)"
      (dragleave)="onDragLeave($event)"
      (drop)="onDrop($event)"
    >
      <input
        type="file"
        id="fileInput"
        class="upload-input"
        [multiple]="true"
        (change)="onFileInputChange($event)"
        [disabled]="isProcessing()"
      />
      <label for="fileInput" class="upload-label">
        <span class="upload-title">Drop files here or click to browse</span>
        <span class="upload-subtitle">Max 10 files per upload</span>
      </label>
    </div>

    @if (activeTabConfig()?.nameHint) {
      <p class="upload-hint">
        {{ activeTabConfig()?.nameHint }}
      </p>
    }

    @if (statusMessage()) {
      <div class="status-message" [class.error]="statusType() === 'error'">
        {{ statusMessage() }}
      </div>
    }

    @if (uploadedFiles().length > 0) {
      <div class="file-list">
        @for (file of uploadedFiles(); track trackByFile($index, file); let i = $index) {
          <div class="file-row">
            <div class="file-info">
              <span class="file-name" [class.invalid]="!file.isValid">{{ file.name }}</span>
              <span class="file-size">{{ formatFileSize(file.size) }}</span>
              @if (!file.isValid) {
                <span class="file-error">{{ file.error }}</span>
              }
            </div>
            <button
              type="button"
              appButton
              class="btn btn-icon btn-text remove-btn"
              (click)="removeFile(i)"
              [disabled]="isProcessing()"
              aria-label="Remove file"
            >
              <i class="fa-solid fa-xmark"></i>
            </button>
          </div>
        }
      </div>
    }
  </div>
</div>
