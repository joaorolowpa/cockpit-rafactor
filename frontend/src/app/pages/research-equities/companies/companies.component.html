<div appPageContainer>
  <div appPageHeader>
    <div>
      <h1 class="page-title">Companies</h1>
      <p class="page-subtitle">Overview of all companies</p>
    </div>
  </div>

  <div appFiltersBar>
    <app-search-input
      placeholder="Search for a company..."
      [value]="searchTerm()"
      [disabled]="loading()"
      (valueChange)="searchTerm.set($event); onSearch()"
      (cleared)="clearSearch()"
    ></app-search-input>
  </div>

  @if (loading()) {
    <app-state
      type="loading"
      icon="pi pi-spinner pi-spin"
      message="Loading companies..."
    ></app-state>
  }

  @if (error() && !loading()) {
    <app-state
      type="error"
      icon="pi pi-exclamation-circle"
      [message]="error() || ''"
      actionLabel="Retry"
      (action)="loadCompanies()"
    ></app-state>
  }

  @if (!loading() && !error()) {
    <ul role="list" class="companies-grid">
      @for (company of filteredCompanies(); track company.id) {
        <li class="companies-item">
          <a
            class="company-card"
            [routerLink]="['/research-equities/companies', company.id]"
          >
            <div class="company-initial">
              {{ company.display_name.charAt(0) }}
            </div>
            <div class="company-info">
              <span class="company-name">{{ company.display_name }}</span>
            </div>
          </a>
        </li>
      }
    </ul>
  }

  @if (!loading() && !error() && filteredCompanies().length === 0) {
    <app-state
      type="empty"
      icon="pi pi-search"
      message="No companies found"
    ></app-state>
  }
</div>
