<div class="feed-container">
  <div class="feed-header">
    <h2>Recent Company Documents</h2>
  </div>

  @if (isLoading()) {
    <div class="loading-state">
      <i class="pi pi-spinner pi-spin"></i>
      <p>Loading recent documents...</p>
    </div>
  } @else if (errorMessage()) {
    <div class="feed-state">{{ errorMessage() }}</div>
  } @else if (allDocuments().length === 0) {
    <div class="feed-state">No recent documents found</div>
  } @else {
    <div class="feed-groups">
      @for (group of groupedDocuments(); track group.date) {
        <div class="feed-card">
          <div class="feed-card-header">
            <span class="feed-date">{{ group.displayDate }}</span>
          </div>
          <div class="feed-card-body">
            @for (doc of group.documents; track doc) {
              <div class="doc-row">
                <div class="doc-content">
                  <div class="doc-date-key">{{ group.date }}</div>
                  <div class="doc-meta-line">
                    Created at {{ formatCreatedAt(doc.created_at) }} by {{ doc.creator_name }}
                  </div>
                </div>
                <div class="doc-actions">
                  <button
                    class="btn btn-text doc-download-btn"
                    type="button"
                    (click)="downloadDocument(doc)"
                  >
                    <i class="pi pi-download"></i>
                    <span>Download</span>
                  </button>
                </div>
              </div>
            }
          </div>
        </div>
      }
    </div>

    @if (hasMore()) {
      <div class="feed-footer">
        <button class="btn btn-secondary" type="button" (click)="loadMore()">
          Load More Documents
        </button>
      </div>
    }
  }
</div>
