<div class="feed-container">
  <div class="feed-header">
    <h2>Recent Company Documents</h2>
  </div>

  @if (isLoading()) {
    <div class="feed-state">Loading recent documents...</div>
  } @else if (errorMessage()) {
    <div class="feed-state">{{ errorMessage() }}</div>
  } @else if (allDocuments().length === 0) {
    <div class="feed-state">No recent documents found</div>
  } @else {
    <div class="feed-groups">
      @for (group of groupedDocuments(); track group.date) {
        <div class="feed-card">
          <div class="feed-card-header">
            <span class="feed-date">{{ group.displayDate }}</span>
          </div>
          <div class="feed-card-body">
            <div class="doc-row" *ngFor="let doc of group.documents">
              <div class="doc-content">
                <div class="doc-date-key">{{ group.date }}</div>
                <div class="doc-meta-line">
                  Created at {{ formatCreatedAt(doc.created_at) }} by {{ doc.creator_name }}
                </div>
              </div>
              <div class="doc-actions">
                <button
                  pButton
                  type="button"
                  icon="pi pi-download"
                  label=""
                  class="p-button-text p-button-plain doc-download-btn"
                  (click)="downloadDocument(doc)"
                ></button>
              </div>
            </div>
          </div>
        </div>
      }
    </div>

    @if (hasMore()) {
      <div class="feed-footer">
        <button pButton class="btn-secondary" type="button" (click)="loadMore()">
          Load More Documents
        </button>
      </div>
    }
  }
</div>
